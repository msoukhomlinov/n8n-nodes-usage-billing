---
description: n8n node, Security best practices and requirements for handling credentials, authentication, and data protection in n8n nodes. [security, credentials, authentication, encryption, validation]
globs: 
alwaysApply: false
---
---
description: n8n node, Security best practices and requirements for handling credentials, authentication, and data protection in n8n nodes. [security, credentials, authentication, encryption, validation]
globs: 
---
# n8n Node Security Standards

1. Credential Handling
   - Never store credentials in code
   - Use n8n credential system
   - Implement proper encryption
   - Example structure:
   ```typescript
   export class AutotaskApiCredentials implements ICredentialType {
     name = 'autotaskApi';
     displayName = 'Autotask API';
     properties = [
       {
         displayName: 'API Key',
         name: 'apiKey',
         type: 'string',
         typeOptions: {
           password: true,
         },
         required: true,
       },
     ];
   }
   ```

2. Authentication
   - Use secure authentication methods
   - Implement proper token handling
   - Handle refresh tokens correctly
   - Validate authentication responses

3. Data Security
   - Sanitize input data
   - Validate output data
   - Handle sensitive data appropriately
   - Implement proper error masking

4. API Security
   - Use HTTPS only
   - Implement rate limiting
   - Handle API versions securely
   - Validate API responses

5. Security Testing
   - Test authentication flows
   - Validate credential handling
   - Test error scenarios
   - Check for security vulnerabilities

## Dependencies
[n8n-build-node_implementation.mdc](mdc:.cursor/rules/n8n-build-node_implementation.mdc)

